*Get authorized - please copy and paste this into a new window, then click on "allow" to get a new token for your SAS session:
https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com/auth/bigquery+https://www.googleapis.com/auth/cloud-platform&response_type=code&access_type=offline&prompt=consent&redirect_uri=https://ws-viya.dna.prd.equifax.com/callback&client_id=307785872942-fi3m7vs2ni68v0mjnlf558cq4loue9uo.apps.googleusercontent.com
;

*%get_refresh_token(4/0AWtgzh4F95KG2m2Qdg7tBGKDJT_tvHSpalMGYnUf9DBP5tC0vDzRZQDAmj6N4yc51e4k9Q);

%bq_connect(MYTEST, PROJECT="dfa-dna-ws5056-us-prd-7402", SCHEMA="dfa_dna_ws5056_us_prd_sandbox", read_mode=STORAGE , SCANSTRINGCOLUMNS=YES)
;


option compress= yes obs =max dlcreatedir;

libname OUTPATH "/export/home/wxg30/nc_data/";

data OUTPATH.wg_extract_baseline_split;

length CNX_Key $12;
length Surrogate_Key $40;
length Exch Zip_four $4;
length Company_cd Srv_Typ $10;
length Account_number $30;
length State_cd $2;
length Zip $5;
length Acct_Typ Acct_status Last_Acct_status S01 S02 S03 S04 S05 S06 S07 S08 S09 S10 S11 S12 S13 S14 S15 S16 S17 S18 S19 S20 S21 S22 S23 S24 $1;

set MYTEST.wg_extract_baseline;

CNX_Key = scan(payment_account_grid,1, "|", "M");
Surrogate_Key = scan(payment_account_grid,2, "|", "M");
Exch = scan(payment_account_grid,3, "|", "M");
Company_cd = scan(payment_account_grid,4, "|", "M");
Reportg_dt = input(scan(payment_account_grid,5, "|", "M"),yymmdd10.);
Account_number = scan(payment_account_grid,6, "|", "M");
State_cd = scan(payment_account_grid,7, "|", "M");
Zip = scan(payment_account_grid,8, "|", "M");
Zip_four = scan(payment_account_grid,9, "|", "M");
Acct_Typ = scan(payment_account_grid,10, "|", "M");
Srv_Typ = scan(payment_account_grid,11, "|", "M");
Acct_status = scan(payment_account_grid,12, "|", "M");
Connect_dt = input(scan(payment_account_grid,13, "|", "M"),yymmdd10.);
Disconnect_dt = input(scan(payment_account_grid,14, "|", "M"),yymmdd10.);
Charge_off_amt = input(scan(payment_account_grid,15, "|", "M"),BEST12.2);
Curr_Bal_dt = input(scan(payment_account_grid,16, "|", "M"),yymmdd10.);
Pmt_Amt = input(scan(payment_account_grid,17, "|", "M"),BEST12.2);
Curr_bal = input(scan(payment_account_grid,18, "|", "M"),BEST12.2);
Last_Reporting_date = input(scan(payment_account_grid,19, "|", "M"),yymmdd10.);
Last_Acct_status = scan(payment_account_grid,20, "|", "M");
Expiration_dt = input(scan(payment_account_grid,21, "|", "M"),yymmdd10.);
* If there are more than 24 months, then please add additional lines of code to read in the additional fields
from the payment grid to support the additional months - lines below only support up to 24 months;
DT01 = input(scan(payment_account_grid,22, "|", "M"),yymmdd10.);
PMT01 = input(scan(payment_account_grid,23, "|", "M"),BEST12.2);
BAL01 = input(scan(payment_account_grid,24, "|", "M"),BEST12.2);
CHG01 = input(scan(payment_account_grid,25, "|", "M"),BEST12.2);
S01 = scan(payment_account_grid,26, "|", "M");
Hist_Connect_dt01 = input(scan(payment_account_grid,27, "|", "M"),yymmdd10.);
Hist_Disconnect_dt01 = input(scan(payment_account_grid,28, "|", "M"),yymmdd10.);
DT02 = input(scan(payment_account_grid,29, "|", "M"),yymmdd10.);
PMT02 = input(scan(payment_account_grid,30, "|", "M"),BEST12.2);
BAL02 = input(scan(payment_account_grid,31, "|", "M"),BEST12.2);
CHG02 = input(scan(payment_account_grid,32, "|", "M"),BEST12.2);
S02 = scan(payment_account_grid,33, "|", "M");
Hist_Connect_dt02 = input(scan(payment_account_grid,34, "|", "M"),yymmdd10.);
Hist_Disconnect_dt02 = input(scan(payment_account_grid,35, "|", "M"),yymmdd10.);
DT03 = input(scan(payment_account_grid,36, "|", "M"),yymmdd10.);
PMT03 = input(scan(payment_account_grid,37, "|", "M"),BEST12.2);
BAL03 = input(scan(payment_account_grid,38, "|", "M"),BEST12.2);
CHG03 = input(scan(payment_account_grid,39, "|", "M"),BEST12.2);
S03 = scan(payment_account_grid,40, "|", "M");
Hist_Connect_dt03 = input(scan(payment_account_grid,41, "|", "M"),yymmdd10.);
Hist_Disconnect_dt03 = input(scan(payment_account_grid,42, "|", "M"),yymmdd10.);
DT04 = input(scan(payment_account_grid,43, "|", "M"),yymmdd10.);
PMT04 = input(scan(payment_account_grid,44, "|", "M"),BEST12.2);
BAL04 = input(scan(payment_account_grid,45, "|", "M"),BEST12.2);
CHG04 = input(scan(payment_account_grid,46, "|", "M"),BEST12.2);
S04 = scan(payment_account_grid,47, "|", "M");
Hist_Connect_dt04 = input(scan(payment_account_grid,48, "|", "M"),yymmdd10.);
Hist_Disconnect_dt04 = input(scan(payment_account_grid,49, "|", "M"),yymmdd10.);
DT05 = input(scan(payment_account_grid,50, "|", "M"),yymmdd10.);
PMT05 = input(scan(payment_account_grid,51, "|", "M"),BEST12.2);
BAL05 = input(scan(payment_account_grid,52, "|", "M"),BEST12.2);
CHG05 = input(scan(payment_account_grid,53, "|", "M"),BEST12.2);
S05 = scan(payment_account_grid,54, "|", "M");
Hist_Connect_dt05 = input(scan(payment_account_grid,55, "|", "M"),yymmdd10.);
Hist_Disconnect_dt05 = input(scan(payment_account_grid,56, "|", "M"),yymmdd10.);
DT06 = input(scan(payment_account_grid,57, "|", "M"),yymmdd10.);
PMT06 = input(scan(payment_account_grid,58, "|", "M"),BEST12.2);
BAL06 = input(scan(payment_account_grid,59, "|", "M"),BEST12.2);
CHG06 = input(scan(payment_account_grid,60, "|", "M"),BEST12.2);
S06 = scan(payment_account_grid,61, "|", "M");
Hist_Connect_dt06 = input(scan(payment_account_grid,62, "|", "M"),yymmdd10.);
Hist_Disconnect_dt06 = input(scan(payment_account_grid,63, "|", "M"),yymmdd10.);
DT07 = input(scan(payment_account_grid,64, "|", "M"),yymmdd10.);
PMT07 = input(scan(payment_account_grid,65, "|", "M"),BEST12.2);
BAL07 = input(scan(payment_account_grid,66, "|", "M"),BEST12.2);
CHG07 = input(scan(payment_account_grid,67, "|", "M"),BEST12.2);
S07 = scan(payment_account_grid,68, "|", "M");
Hist_Connect_dt07 = input(scan(payment_account_grid,69, "|", "M"),yymmdd10.);
Hist_Disconnect_dt07 = input(scan(payment_account_grid,70, "|", "M"),yymmdd10.);
DT08 = input(scan(payment_account_grid,71, "|", "M"),yymmdd10.);
PMT08 = input(scan(payment_account_grid,72, "|", "M"),BEST12.2);
BAL08 = input(scan(payment_account_grid,73, "|", "M"),BEST12.2);
CHG08 = input(scan(payment_account_grid,74, "|", "M"),BEST12.2);
S08 = scan(payment_account_grid,75, "|", "M");
Hist_Connect_dt08 = input(scan(payment_account_grid,76, "|", "M"),yymmdd10.);
Hist_Disconnect_dt08 = input(scan(payment_account_grid,77, "|", "M"),yymmdd10.);
DT09 = input(scan(payment_account_grid,78, "|", "M"),yymmdd10.);
PMT09 = input(scan(payment_account_grid,79, "|", "M"),BEST12.2);
BAL09 = input(scan(payment_account_grid,80, "|", "M"),BEST12.2);
CHG09 = input(scan(payment_account_grid,81, "|", "M"),BEST12.2);
S09 = scan(payment_account_grid,82, "|", "M");
Hist_Connect_dt09 = input(scan(payment_account_grid,83, "|", "M"),yymmdd10.);
Hist_Disconnect_dt09 = input(scan(payment_account_grid,84, "|", "M"),yymmdd10.);
DT10 = input(scan(payment_account_grid,85, "|", "M"),yymmdd10.);
PMT10 = input(scan(payment_account_grid,86, "|", "M"),BEST12.2);
BAL10 = input(scan(payment_account_grid,87, "|", "M"),BEST12.2);
CHG10 = input(scan(payment_account_grid,88, "|", "M"),BEST12.2);
S10 = input(scan(payment_account_grid,89, "|", "M"),BEST12.2);
Hist_Connect_dt10 = input(scan(payment_account_grid,90, "|", "M"),yymmdd10.);
Hist_Disconnect_dt10 = input(scan(payment_account_grid,91, "|", "M"),yymmdd10.);
DT11 = input(scan(payment_account_grid,92, "|", "M"),yymmdd10.);
PMT11 = input(scan(payment_account_grid,93, "|", "M"),BEST12.2);
BAL11 = input(scan(payment_account_grid,94, "|", "M"),BEST12.2);
CHG11 = input(scan(payment_account_grid,95, "|", "M"),BEST12.2);
S11 = scan(payment_account_grid,96, "|", "M");
Hist_Connect_dt11 = input(scan(payment_account_grid,97, "|", "M"),yymmdd10.);
Hist_Disconnect_dt11 = input(scan(payment_account_grid,98, "|", "M"),yymmdd10.);
DT12 = input(scan(payment_account_grid,99, "|", "M"),yymmdd10.);
PMT12 = input(scan(payment_account_grid,100, "|", "M"),BEST12.2);
BAL12 = input(scan(payment_account_grid,101, "|", "M"),BEST12.2);
CHG12 = input(scan(payment_account_grid,102, "|", "M"),BEST12.2);
S12 = scan(payment_account_grid,103, "|", "M");
Hist_Connect_dt12 = input(scan(payment_account_grid,104, "|", "M"),yymmdd10.);
Hist_Disconnect_dt12 = input(scan(payment_account_grid,105, "|", "M"),yymmdd10.);
DT13 = input(scan(payment_account_grid,106, "|", "M"),yymmdd10.);
PMT13 = input(scan(payment_account_grid,107, "|", "M"),BEST12.2);
BAL13 = input(scan(payment_account_grid,108, "|", "M"),BEST12.2);
CHG13 = input(scan(payment_account_grid,109, "|", "M"),BEST12.2);
S13 = scan(payment_account_grid,110, "|", "M");
Hist_Connect_dt13 = input(scan(payment_account_grid,111, "|", "M"),yymmdd10.);
Hist_Disconnect_dt13 = input(scan(payment_account_grid,112, "|", "M"),yymmdd10.);
DT14 = input(scan(payment_account_grid,113, "|", "M"),yymmdd10.);
PMT14 = input(scan(payment_account_grid,114, "|", "M"),BEST12.2);
BAL14 = input(scan(payment_account_grid,115, "|", "M"),BEST12.2);
CHG14 = input(scan(payment_account_grid,116, "|", "M"),BEST12.2);
S14 = scan(payment_account_grid,117, "|", "M");
Hist_Connect_dt14 = input(scan(payment_account_grid,118, "|", "M"),yymmdd10.);
Hist_Disconnect_dt14 = input(scan(payment_account_grid,119, "|", "M"),yymmdd10.);
DT15 = input(scan(payment_account_grid,120, "|", "M"),yymmdd10.);
PMT15 = input(scan(payment_account_grid,121, "|", "M"),BEST12.2);
BAL15 = input(scan(payment_account_grid,122, "|", "M"),BEST12.2);
CHG15 = input(scan(payment_account_grid,123, "|", "M"),BEST12.2);
S15 = scan(payment_account_grid,124, "|", "M");
Hist_Connect_dt15 = input(scan(payment_account_grid,125, "|", "M"),yymmdd10.);
Hist_Disconnect_dt15 = input(scan(payment_account_grid,126, "|", "M"),yymmdd10.);
DT16 = input(scan(payment_account_grid,127, "|", "M"),yymmdd10.);
PMT16 = input(scan(payment_account_grid,128, "|", "M"),BEST12.2);
BAL16 = input(scan(payment_account_grid,129, "|", "M"),BEST12.2);
CHG16 = input(scan(payment_account_grid,130, "|", "M"),BEST12.2);
S16 = scan(payment_account_grid,131, "|", "M");
Hist_Connect_dt16 = input(scan(payment_account_grid,132, "|", "M"),yymmdd10.);
Hist_Disconnect_dt16 = input(scan(payment_account_grid,133, "|", "M"),yymmdd10.);
DT17 = input(scan(payment_account_grid,134, "|", "M"),yymmdd10.);
PMT17 = input(scan(payment_account_grid,135, "|", "M"),BEST12.2);
BAL17 = input(scan(payment_account_grid,136, "|", "M"),BEST12.2);
CHG17 = input(scan(payment_account_grid,137, "|", "M"),BEST12.2);
S17 = scan(payment_account_grid,138, "|", "M");
Hist_Connect_dt17 = input(scan(payment_account_grid,139, "|", "M"),yymmdd10.);
Hist_Disconnect_dt17 = input(scan(payment_account_grid,140, "|", "M"),yymmdd10.);
DT18 = input(scan(payment_account_grid,141, "|", "M"),yymmdd10.);
PMT18 = input(scan(payment_account_grid,142, "|", "M"),BEST12.2);
BAL18 = input(scan(payment_account_grid,143, "|", "M"),BEST12.2);
CHG18 = input(scan(payment_account_grid,144, "|", "M"),BEST12.2);
S18 = scan(payment_account_grid,145, "|", "M");
Hist_Connect_dt18 = input(scan(payment_account_grid,146, "|", "M"),yymmdd10.);
Hist_Disconnect_dt18 = input(scan(payment_account_grid,147, "|", "M"),yymmdd10.);
DT19 = input(scan(payment_account_grid,148, "|", "M"),yymmdd10.);
PMT19 = input(scan(payment_account_grid,149, "|", "M"),BEST12.2);
BAL19 = input(scan(payment_account_grid,150, "|", "M"),BEST12.2);
CHG19 = input(scan(payment_account_grid,151, "|", "M"),BEST12.2);
S19 = scan(payment_account_grid,152, "|", "M");
Hist_Connect_dt19 = input(scan(payment_account_grid,153, "|", "M"),yymmdd10.);
Hist_Disconnect_dt19 = input(scan(payment_account_grid,154, "|", "M"),yymmdd10.);
DT20 = input(scan(payment_account_grid,155, "|", "M"),yymmdd10.);
PMT20 = input(scan(payment_account_grid,156, "|", "M"),BEST12.2);
BAL20 = input(scan(payment_account_grid,157, "|", "M"),BEST12.2);
CHG20 = input(scan(payment_account_grid,158, "|", "M"),BEST12.2);
S20 = scan(payment_account_grid,159, "|", "M");
Hist_Connect_dt20 = input(scan(payment_account_grid,160, "|", "M"),yymmdd10.);
Hist_Disconnect_dt20 = input(scan(payment_account_grid,161, "|", "M"),yymmdd10.);
DT21 = input(scan(payment_account_grid,162, "|", "M"),yymmdd10.);
PMT21 = input(scan(payment_account_grid,163, "|", "M"),BEST12.2);
BAL21 = input(scan(payment_account_grid,164, "|", "M"),BEST12.2);
CHG21 = input(scan(payment_account_grid,165, "|", "M"),BEST12.2);
S21 = scan(payment_account_grid,166, "|", "M");
Hist_Connect_dt21 = input(scan(payment_account_grid,167, "|", "M"),yymmdd10.);
Hist_Disconnect_dt21 = input(scan(payment_account_grid,168, "|", "M"),yymmdd10.);
DT22 = input(scan(payment_account_grid,169, "|", "M"),yymmdd10.);
PMT22 = input(scan(payment_account_grid,170, "|", "M"),BEST12.2);
BAL22 = input(scan(payment_account_grid,171, "|", "M"),BEST12.2);
CHG22 = input(scan(payment_account_grid,172, "|", "M"),BEST12.2);
S22 = scan(payment_account_grid,173, "|", "M");
Hist_Connect_dt22 = input(scan(payment_account_grid,174, "|", "M"),yymmdd10.);
Hist_Disconnect_dt22 = input(scan(payment_account_grid,175, "|", "M"),yymmdd10.);
DT23 = input(scan(payment_account_grid,176, "|", "M"),yymmdd10.);
PMT23 = input(scan(payment_account_grid,177, "|", "M"),BEST12.2);
BAL23 = input(scan(payment_account_grid,178, "|", "M"),BEST12.2);
CHG23 = input(scan(payment_account_grid,179, "|", "M"),BEST12.2);
S23 = scan(payment_account_grid,180, "|", "M");
Hist_Connect_dt23 = input(scan(payment_account_grid,181, "|", "M"),yymmdd10.);
Hist_Disconnect_dt23 = input(scan(payment_account_grid,182, "|", "M"),yymmdd10.);
DT24 = input(scan(payment_account_grid,183, "|", "M"),yymmdd10.);
PMT24 = input(scan(payment_account_grid,184, "|", "M"),BEST12.2);
BAL24 = input(scan(payment_account_grid,185, "|", "M"),BEST12.2);
CHG24 = input(scan(payment_account_grid,186, "|", "M"),BEST12.2);
S24 = scan(payment_account_grid,187, "|", "M");
Hist_Connect_dt24 = input(scan(payment_account_grid,188, "|", "M"),yymmdd10.);
Hist_Disconnect_dt24 = input(scan(payment_account_grid,189, "|", "M"),yymmdd10.);
drop payment_account_grid;
format Reportg_dt Connect_dt Disconnect_dt Curr_Bal_dt Last_Reporting_date Expiration_dt 
DT01 Hist_Connect_dt01 Hist_Disconnect_dt01 DT02 Hist_Connect_dt02 Hist_Disconnect_dt02 DT03 Hist_Connect_dt03 Hist_Disconnect_dt03 DT04 Hist_Connect_dt04 Hist_Disconnect_dt04 DT05 Hist_Connect_dt05 Hist_Disconnect_dt05 DT06 Hist_Connect_dt06 Hist_Disconnect_dt06 DT07 Hist_Connect_dt07 Hist_Disconnect_dt07 DT08 Hist_Connect_dt08 Hist_Disconnect_dt08 DT09 Hist_Connect_dt09 Hist_Disconnect_dt09 DT10 Hist_Connect_dt10 Hist_Disconnect_dt10 DT11 Hist_Connect_dt11 Hist_Disconnect_dt11 DT12 Hist_Connect_dt12 Hist_Disconnect_dt12 DT13 Hist_Connect_dt13 Hist_Disconnect_dt13 DT14 Hist_Connect_dt14 Hist_Disconnect_dt14 DT15 Hist_Connect_dt15 Hist_Disconnect_dt15 DT16 Hist_Connect_dt16 Hist_Disconnect_dt16 DT17 Hist_Connect_dt17 Hist_Disconnect_dt17 DT18 Hist_Connect_dt18 Hist_Disconnect_dt18 DT19 Hist_Connect_dt19 Hist_Disconnect_dt19 DT20 Hist_Connect_dt20 Hist_Disconnect_dt20 DT21 Hist_Connect_dt21 Hist_Disconnect_dt21 DT22 Hist_Connect_dt22 Hist_Disconnect_dt22 DT23 Hist_Connect_dt23 Hist_Disconnect_dt23 DT24 Hist_Connect_dt24 Hist_Disconnect_dt24 yymmdd10.;
format Charge_off_amt Pmt_Amt Curr_bal  PMT01 BAL01 CHG01 PMT02 BAL02  CHG02 PMT03 BAL03 CHG03 PMT04  BAL04 CHG04 PMT05 BAL05 CHG05  PMT06 BAL06 CHG06 PMT07 BAL07  CHG07 PMT08 BAL08 CHG08 PMT09  BAL09 CHG09 PMT10 BAL10 CHG10  PMT11 BAL11 CHG11 PMT12 BAL12  CHG12 PMT13 BAL13 CHG13 PMT14 BAL14 CHG14 PMT15 BAL15 CHG15 PMT16 BAL16 CHG16 PMT17 BAL17 CHG17 PMT18 BAL18 CHG18 PMT19 BAL19 CHG19 PMT20 BAL20 CHG20 PMT21 BAL21 CHG21 PMT22 BAL22 CHG22 PMT23 BAL23 CHG23 PMT24 BAL24 CHG24 BEST12.2;
run;
